{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Coordinator Hub ‚Äî Dashboard</title>

  <!-- Bootstrap + Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#1c1c1c;
  --secondary:#555;
  --accent:#cccccc;
  --background:#F8F9FC;
  --text-dark:#2E2E2E;
  --text-light:#fff;
}

*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Montserrat,sans-serif;
  background:linear-gradient(120deg,var(--background),#fff);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.dashboard-wrapper{
  width:95%;
  max-width:1400px;
  height:90vh;
  border-radius:20px;
  overflow:hidden;
  display:flex;
  background:var(--primary);
  box-shadow:0 20px 50px rgba(0,0,0,.25);
}

/* Sidebar */
.sidebar{
  width:270px;
  padding:26px 18px;
  background:linear-gradient(180deg,var(--primary),var(--secondary));
  color:var(--text-light);
}

.brand{
  display:flex;
  gap:10px;
  border-bottom:1px solid rgba(255,255,255,.15);
  padding-bottom:12px;
  margin-bottom:14px;
}
.brand h4{margin:0;color:var(--accent);}

.nav-item{
  padding:12px 14px;
  border-radius:12px;
  cursor:pointer;
  display:flex;
  gap:12px;
  align-items:center;
  transition:.25s;
}
.nav-item:hover{background:rgba(255,255,255,.15);transform:translateX(6px);}
.nav-item.active{
  background:linear-gradient(90deg,var(--accent),var(--secondary));
  color:#000;
}

/* Main */
.main-content{
  flex:1;
  padding:26px;
  background:var(--background);
  overflow:auto;
}

.topbar{
  display:flex;
  justify-content:space-between;
  margin-bottom:25px;
}

.left-top{
  display:flex;
  align-items:center;
  gap:12px;
}

.avatar{
  width:50px;height:50px;border-radius:50%;
  background:var(--secondary);
  display:flex;align-items:center;justify-content:center;
  color:#fff;font-weight:700;
}

.content-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:20px;
}

.card-lg{
  background:linear-gradient(135deg,var(--primary),var(--secondary));
  color:#fff;
  padding:20px;
  border-radius:14px;
  position:relative;
}

.card-lg.alt{
  background:linear-gradient(135deg,var(--accent),var(--secondary));
  color:#000;
}

.card-lg i{
  position:absolute;
  right:12px;top:12px;
  font-size:2rem;opacity:.15;
}

.card-action{
  display:inline-block;
  background:var(--accent);
  color:#000;
  padding:8px 16px;
  border-radius:8px;
  font-weight:600;
  text-decoration:none;
}

.section{display:block;}
.d-none{display:none;}
</style>
</head>

<body>
<div class="dashboard-wrapper">

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="brand">
<<<<<<< HEAD
    <i class="fas fa-user"></i>
    <h4>Coordinator Hub</h4>
  </div>

  <div class="nav-item active" onclick="showSection('overview', this)">
    <i class="fas fa-home"></i> Overview
  </div>

  <div class="nav-item" onclick="showSection('announce', this)">
    <i class="fas fa-bullhorn"></i> Announcements
  </div>

  <div class="nav-item" onclick="showSection('csvUpload', this)">
    <i class="fas fa-file-csv"></i> Student CSV Upload
  </div>
</aside>


=======
    <i class="fas fa-user"></i><h4>Coordinator Hub</h4>
  </div>
  <div class="nav-item active" onclick="showSection('overview',this)">
    <i class="fas fa-home"></i> Overview
  </div>
  <div class="nav-item" onclick="showSection('announce',this)">
    <i class="fas fa-bullhorn"></i> Announcements
  </div>
  <div class="nav-item" onclick="showSection('chat',this)">
    <i class="fas fa-comments"></i> Chatbot
  </div>
</aside>

>>>>>>> 9db60b58a4c4f0174abb69e50ae40ee60c252640
<!-- MAIN -->
<main class="main-content">

<!-- TOPBAR -->
<div class="topbar">
  <div class="left-top">
    <div class="avatar">
      {{ coordinator.name|default:"C"|slice:":1" }}
    </div>
    <div>
      <div style="font-weight:700">
        Welcome, {{ coordinator.name|default:"Coordinator" }}
      </div>
      <div style="font-size:.85rem">KGISL Institute</div>
    </div>
    <div id="clock" style="margin-left:12px;font-weight:600"></div>
  </div>
</div>

<!-- OVERVIEW -->
<section id="overview" class="section">
<h5>Overview</h5>
<div class="content-grid">

<div class="card-lg">
<i class="fas fa-bullhorn"></i>
<h6>Post Announcement</h6>
<p>Deadlines, schedules & instructions</p>
<a class="card-action" onclick="showSection('announce')">Create</a>
</div>

<div class="card-lg alt">
<i class="fas fa-user-graduate"></i>
<h6>Mentor List</h6>
<a class="card-action" href="{% url 'men_list' %}">Open</a>
</div>

<div class="card-lg">
<i class="fas fa-users"></i>
<h6>Team List</h6>
<a class="card-action" href="{% url 'team_list' %}">View</a>
</div>

<div class="card-lg alt">
<i class="fas fa-user-tie"></i>
<h6>Allocate Mentor</h6>
<a class="card-action" href="{% url 'run_allocation' %}">Allocate</a>
</div>

<div class="card-lg">
<i class="fas fa-book"></i>
<h6>Circulate Rubrics</h6>
<a class="card-action" href="#">Share</a>
</div>

</div>
</section>

<!-- ANNOUNCEMENTS -->
<section id="announce" class="section d-none">
<h5>üì¢ Create Announcement</h5>

<form method="post">
{% csrf_token %}

<div class="mb-2">
  <input class="form-control" name="title" placeholder="Announcement Title">
</div>

<div class="mb-2">
  <select class="form-select" name="ann_type" id="annType" onchange="toggleFields()">
    <option value="">Select Announcement Type</option>
    <option value="deadline">Deadline</option>
    <option value="schedule">Schedule</option>
    <option value="instruction">Instruction</option>
  </select>
</div>

<div class="mb-2">
  <select class="form-select" name="target">
    <option value="student">Students</option>
    <option value="mentor">Mentors</option>
    <option value="both">Students & Mentors</option>
  </select>
</div>

<div id="deadlineFields" class="d-none">
  <input type="date" name="deadline_date" class="form-control mb-2">
  <input type="time" name="deadline_time" class="form-control mb-2">
</div>

<div id="scheduleFields" class="d-none">
  <input type="date" name="schedule_date" class="form-control mb-2">
  <input class="form-control mb-2" name="schedule_time" placeholder="Time Slot">
  <input class="form-control mb-2" name="venue" placeholder="Venue / Mode">
</div>

<div id="instructionFields" class="d-none">
  <textarea class="form-control mb-2" name="message" placeholder="Detailed Instructions"></textarea>
</div>

<button class="btn btn-primary">Send Announcement</button>
</form>
</section>

<!-- CHAT -->
<<<<<<< HEAD
<section id="csvUpload" class="section d-none">
<h5>üì§ Student CSV Upload</h5>

<div class="card-lg alt" style="background:#fff">

  <div class="info mb-3" style="background:#e8f1ff;padding:15px;border-left:4px solid #0d6efd">
    <strong>CSV Format Required:</strong>
    <table class="table table-sm mt-2">
      <thead>
        <tr>
          <th>student_id</th>
          <th>name</th>
          <th>cgpa</th>
          <th>class</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>24UCS201</td>
          <td>Salis</td>
          <td>8.5</td>
          <td>CSE-B</td>
        </tr>
      </tbody>
    </table>
  </div>

  <form method="post" enctype="multipart/form-data" action="{% url 'upload_csv' %}">
    {% csrf_token %}
    <input type="file" name="file" accept=".csv" class="form-control mb-3" required>
    <button type="submit" class="btn btn-success">Upload CSV</button>
  </form>

  {% if error %}
    <div class="alert alert-danger mt-3">{{ error }}</div>
  {% endif %}

  {% if show_results %}
    {% if allowed %}
    <div class="alert alert-success mt-4">
      <h6>‚úÖ Imported Successfully ({{ allowed|length }})</h6>
      <table class="table table-bordered mt-2">
        <tr>
          <th>ID</th><th>Name</th><th>CGPA</th><th>Class</th>
        </tr>
        {% for s in allowed %}
        <tr>
          <td>{{ s.student_id }}</td>
          <td>{{ s.name }}</td>
          <td>{{ s.cgpa }}</td>
          <td>{{ s.class }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    {% endif %}

    {% if not_allowed %}
    <div class="alert alert-danger mt-4">
      <h6>‚ùå Failed Records ({{ not_allowed|length }})</h6>
      <table class="table table-bordered mt-2">
        <tr>
          <th>ID</th><th>Name</th><th>Reason</th>
        </tr>
        {% for s in not_allowed %}
        <tr>
          <td>{{ s.student_id }}</td>
          <td>{{ s.name }}</td>
          <td>{{ s.reason }}</td>
        </tr>
        {% endfor %}
      </table>
    </div>
    {% endif %}
  {% endif %}

</div>
</section>


=======
<section id="chat" class="section d-none">
<h5>Chatbot</h5>
<div id="chatBox" style="background:#fff;height:300px;padding:10px;overflow:auto;border-radius:10px"></div>
<div class="d-flex mt-2 gap-2">
<input id="chatInput" class="form-control">
<button class="btn btn-primary" onclick="sendChat()">Send</button>
</div>
</section>

>>>>>>> 9db60b58a4c4f0174abb69e50ae40ee60c252640
</main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
<<<<<<< HEAD
/* =========================
   SECTION SWITCHING
========================= */
function showSection(id, el) {
  document.querySelectorAll('.section').forEach(s => s.classList.add('d-none'));

  const activeSection = document.getElementById(id);
  if (activeSection) {
    activeSection.classList.remove('d-none');
  }

  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  if (el) el.classList.add('active');
}

/* =========================
   LIVE CLOCK (SAFE)
========================= */
const clock = document.getElementById("clock");
if (clock) {
  setInterval(() => {
    clock.innerText = new Date().toLocaleTimeString();
  }, 1000);
}

/* =========================
   ANNOUNCEMENT FIELD TOGGLE
========================= */
function toggleFields() {
  const annType = document.getElementById("annType");
  const deadlineFields = document.getElementById("deadlineFields");
  const scheduleFields = document.getElementById("scheduleFields");
  const instructionFields = document.getElementById("instructionFields");

  if (!annType) return;

  deadlineFields?.classList.add("d-none");
  scheduleFields?.classList.add("d-none");
  instructionFields?.classList.add("d-none");

  if (annType.value === "deadline") {
    deadlineFields?.classList.remove("d-none");
  }
  if (annType.value === "schedule") {
    scheduleFields?.classList.remove("d-none");
  }
  if (annType.value === "instruction") {
    instructionFields?.classList.remove("d-none");
  }
}

/* =========================
   AUTO-OPEN CSV SECTION
   (AFTER POST RESULT)
========================= */
document.addEventListener("DOMContentLoaded", function () {
  const hasResults =
    document.querySelector(".alert-success") ||
    document.querySelector(".alert-danger");

  if (hasResults) {
    showSection("csvUpload");
  }
});
=======
function showSection(id,el){
  document.querySelectorAll('.section').forEach(s=>s.classList.add('d-none'));
  document.getElementById(id).classList.remove('d-none');
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  if(el) el.classList.add('active');
}

setInterval(()=>clock.innerText=new Date().toLocaleTimeString(),1000);

function toggleFields(){
  deadlineFields.classList.add('d-none');
  scheduleFields.classList.add('d-none');
  instructionFields.classList.add('d-none');
  if(annType.value==='deadline') deadlineFields.classList.remove('d-none');
  if(annType.value==='schedule') scheduleFields.classList.remove('d-none');
  if(annType.value==='instruction') instructionFields.classList.remove('d-none');
}

function sendChat(){
  let v=chatInput.value.trim();
  if(!v) return;
  chatBox.insertAdjacentHTML('beforeend',`<div><b>You:</b> ${v}</div>`);
  chatInput.value='';
}
>>>>>>> 9db60b58a4c4f0174abb69e50ae40ee60c252640
</script>

</body>
</html>
