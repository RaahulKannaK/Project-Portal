<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student Hub - Modern Dashboard</title>

  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --primary:#2c37ad;
  --secondary:#a1a7c9;
  --accent:#d1d9ff;
  --background:#F8F9FC;
  --text-dark:#2E2E2E;
  --text-light:#fff;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:Montserrat,sans-serif;
  background:linear-gradient(120deg,var(--background),#fff);
  display:flex;
  justify-content:center;
  align-items:center;
  min-height:100vh;
}

.dashboard-wrapper{
  width:95%;
  max-width:1400px;
  height:90vh;
  background:var(--primary);
  border-radius:20px;
  overflow:hidden;
  display:flex;
  box-shadow:0 20px 50px rgba(0,0,0,.25);
}

/* SIDEBAR */
.sidebar{
  width:280px;
  padding:30px 20px;
  background:linear-gradient(180deg,var(--primary),var(--secondary));
  color:var(--text-light);
}

.sidebar-header{
  text-align:center;
  margin-bottom:25px;
  padding-bottom:20px;
  border-bottom:1px solid rgba(255,255,255,.2);
}

.sidebar-header h4{
  margin:0;
  color:var(--accent);
  font-weight:600;
}

.sidebar-nav .nav-item{
  display:flex;
  align-items:center;
  padding:14px 18px;
  margin-bottom:12px;
  border-radius:12px;
  text-decoration:none;
  color:var(--text-light);
  transition:.25s;
}

.sidebar-nav .nav-item i{
  margin-right:14px;
}

.sidebar-nav .nav-item:hover{
  background:rgba(255,255,255,.15);
  transform:translateX(6px);
}

.sidebar-nav .nav-item.active{
  background:linear-gradient(90deg,var(--accent),var(--secondary));
  color:#000;
  font-weight:600;
}

/* MAIN */
.main-content{
  flex:1;
  padding:30px;
  background:var(--background);
  overflow:auto;
}

.top-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:30px;
}

.user-greeting{
  display:flex;
  align-items:center;
  gap:15px;
}

.profile-avatar{
  width:50px;
  height:50px;
  border-radius:50%;
  background:var(--secondary);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:1.4rem;
}

.welcome-text{
  font-size:1.5rem;
  font-weight:600;
}

/* GRID */
.content-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:25px;
}

/* CARDS */
.main-card{
  position:relative;
  padding:25px;
  border-radius:16px;
  color:var(--text-light);
  box-shadow:0 10px 25px rgba(0,0,0,.2);
  transition:.3s;
}

.main-card:hover{
  transform:translateY(-6px);
}

.main-card i{
  position:absolute;
  top:20px;
  right:20px;
  font-size:2rem;
  opacity:.15;
}

.gradient-purple{background:linear-gradient(135deg,var(--primary),var(--secondary));}
.gradient-pink{background:linear-gradient(135deg,var(--accent),var(--secondary)); color:#000;}
.gradient-mixed{background:linear-gradient(135deg,var(--secondary),var(--primary));}

/* BUTTON */
.glass-button{
  background:var(--accent);
  padding:10px 18px;
  border-radius:8px;
  font-weight:600;
  color:#000;
  text-decoration:none;
  transition:.3s;
  display:inline-block;
}

.glass-button:hover{
  background:var(--primary);
  color:#fff;
}

/* ANNOUNCEMENTS */
.announcement-box{
  background:rgba(255,255,255,.15);
  border-radius:10px;
  padding:10px;
  margin-bottom:10px;
}

.footer{
  margin-top:25px;
  text-align:center;
  font-size:.9rem;
  border-top:1px solid #ddd;
  padding-top:12px;
}
</style>
</head>

<body>
<div class="dashboard-wrapper">

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-header">
    <h4><i class="fas fa-graduation-cap me-2"></i>Student Dashboard</h4>
  </div>

  <nav class="sidebar-nav">
    <a class="nav-item active"><i class="fas fa-home"></i>Overview</a>
    <a href="{% url 'zero_stu' %}" class="nav-item"><i class="fas fa-trophy"></i>Reviews</a>
    <a href="#" class="nav-item"><i class="fas fa-chart-line"></i>Dashboard Info</a>
    <a href="#" class="nav-item"><i class="fas fa-cog"></i>Settings</a>
  </nav>
</aside>

<!-- MAIN -->
<main class="main-content">

<!-- TOP -->
<div class="top-header">
  <div class="user-greeting">
    <div class="profile-avatar">
      {{ request.session.student_name|slice:":1" }}
    </div>
    <div class="welcome-text">
      Welcome, {{ request.session.student_name }}!
    </div>
  </div>

  <div class="dropdown">
    <button class="btn btn-light dropdown-toggle" data-bs-toggle="dropdown">
      <i class="fas fa-user"></i>
    </button>
    <ul class="dropdown-menu dropdown-menu-end">
      <li class="dropdown-item text-center fw-bold">
        {{ request.session.student_id }} ‚Äì {{ request.session.student_name }}
      </li>
      <li><hr class="dropdown-divider"></li>
      <li>
        <a class="dropdown-item text-danger fw-bold" href="{% url 'logout' %}">
          <i class="fas fa-sign-out-alt me-2"></i>Logout
        </a>
      </li>
    </ul>
  </div>
</div>

<!-- GRID -->
<div class="content-grid">

<!-- ORIGINAL CARDS (UNCHANGED) -->
<div class="main-card gradient-purple">
  <i class="fas fa-users-cog"></i>
  <h6>Create Team</h6>
  <p>Build your idea by chosing your team here.</p>
  <a href="{% url 'create_team' %}" class="glass-button">Team Up</a>
</div>

<div class="main-card gradient-pink">
  <i class="fas fa-globe"></i>
  <h6>Modify Domains</h6>
  <p>Update your project domain here for a particular time.</p>
  <a href="{% url 'create_team' %}" class="glass-button">Update</a>
</div>

<div class="main-card gradient-mixed">
  <i class="fas fa-chalkboard-teacher"></i>
  <h6>Mentor Connect</h6>
  <p>View mentor allocated to you.</p>
  <a href="{% url 'run_allocation' %}" class="glass-button">View</a>
</div>

<!-- üîî ANNOUNCEMENTS (UPGRADED, NOT REPLACED) -->
<div class="main-card gradient-purple">
  <i class="fas fa-bell"></i>
  <h6>Announcements</h6>

  <!-- üîπ Latest Announcement pinned -->
  {% if latest_announcement %}
    <div class="announcement-box">
      <strong>{{ latest_announcement.announcement.title }}</strong><br>
      <small>{{ latest_announcement.announcement.ann_type|title }}</small>

      {% if latest_announcement.announcement.deadline_date %}
        <div class="small">
          ‚è∞ {{ latest_announcement.announcement.deadline_date }}
          {{ latest_announcement.announcement.deadline_time }}
        </div>
      {% endif %}
    </div>
  {% endif %}

  <!-- üîπ OLD CODE LOOP (UNCHANGED) -->
  <div style="max-height:200px; overflow:auto;">
    {% for status in announcements %}
      <div class="announcement-box">
        <strong>{{ status.announcement.title }}</strong><br>
        <small>{{ status.announcement.ann_type|title }}</small>

        {% if status.announcement.deadline_date %}
          <div class="small">
            ‚è∞ {{ status.announcement.deadline_date }}
            {{ status.announcement.deadline_time }}
          </div>
        {% endif %}

        <div class="text-end mt-1">
          {% if status.acknowledged_at %}
            <i class="fas fa-check-double text-info"></i>
          {% else %}
            <form method="post" action="{% url 'ack_announcement' status.id %}">
              {% csrf_token %}
              <button class="btn btn-sm btn-light">‚úî</button>
            </form>
          {% endif %}
        </div>
      </div>
    {% empty %}
      <p class="text-light">No announcements</p>
    {% endfor %}
  </div>

  <!-- üîπ NEW BUTTON -->
  <button class="glass-button mt-2" data-bs-toggle="modal" data-bs-target="#allAnnouncementsModal">
    View All Announcements
  </button>
</div>

</div>

<div class="footer">
  ¬© 2025 Project Portal. All Rights Reserved.
</div>

</main>
</div>

<!-- üîî MODAL (ADDITION ONLY) -->
<div class="modal fade" id="allAnnouncementsModal" tabindex="-1">
  <div class="modal-dialog modal-lg modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">All Announcements</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        {% for status in all_announcements %}
          <div class="announcement-box">
            <strong>{{ status.announcement.title }}</strong><br>
            <small>{{ status.announcement.ann_type|title }}</small>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
